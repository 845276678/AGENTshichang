# 创意完善工作坊 - 技术实现文档

## 📋 项目概述

### 产品定位
**创意完善工作坊**是一个AI引导式的创意优化系统，通过分析AI竞价评估结果，主动引导用户完善创意的薄弱环节。

### 核心特色
- 🤖 **AI主动引导**：不是被动回答，而是主动提问和建议
- 📊 **数据驱动**：基于6个AI专家的竞价评估，精准定位薄弱维度
- 💬 **深度对话**：每个维度5轮深入讨论，逐步细化
- 📝 **实时文档**：右侧实时展示完善后的结构化创意文档
- 🎯 **流程衔接**：完成后无缝进入MVP构建工作坊

---

## 🎨 UI设计方案

### 整体布局（双栏式）

```
┌──────────────────────────────────────────────────────────────────────┐
│  🎯 创意完善工作坊 - AI引导式优化                [最小化] [关闭]      │
├─────────────────────────────┬────────────────────────────────────────┤
│  左侧（45%）                │  右侧（55%）                           │
│                             │                                        │
│ ┌─────────────────────────┐ │ ┌────────────────────────────────────┐ │
│ │ 📊 竞价评估总结         │ │ │ 📝 完善后的创意文档                │ │
│ │                         │ │ │                                    │ │
│ │ 综合评分: 6.8/10        │ │ │ 【基本信息】                       │ │
│ │ ├─ 目标客户: 5.5 ⚠️    │ │ │ 创意标题: [实时更新]               │ │
│ │ ├─ 核心价值: 7.2 ✓      │ │ │ 行业类型: [实时更新]               │ │
│ │ ├─ 商业模式: 6.0 ⚠️    │ │ │                                    │ │
│ │ └─ 市场潜力: 7.5 ✓      │ │ │ 【目标用户画像】⚡正在完善         │ │
│ │                         │ │ │ 原始版本: [灰色显示]               │ │
│ │ 待完善维度: 2个         │ │ │ ↓ 优化后:                          │ │
│ │ 已完善维度: 0个         │ │ │ • 用户群体: [实时填充]             │ │
│ │                         │ │ │ • 典型画像: [实时填充]             │ │
│ └─────────────────────────┘ │ │ • 核心痛点: [实时填充]             │ │
│                             │ │ • 使用场景: [实时填充]             │ │
│ ┌─────────────────────────┐ │ │                                    │ │
│ │ 💬 AI引导对话           │ │ │ 【商业模式】                       │ │
│ │                         │ │ │ [待完善]                           │ │
│ │ [AI头像] AI教练         │ │ │                                    │ │
│ │ 您好！通过分析6位AI专家 │ │ │ 【市场分析】                       │ │
│ │ 的评估，我们发现您的创意│ │ │ [待完善]                           │ │
│ │ 在【目标客户】和【商业模│ │ │                                    │ │
│ │ 式】两个维度还需完善... │ │ │ 【竞争优势】                       │ │
│ │ [12:30]                 │ │ │ [待完善]                           │ │
│ │                         │ │ └────────────────────────────────────┘ │
│ │ [AI头像] AI教练         │ │                                        │
│ │ 💡 让我们从【目标客户】 │ │ ┌────────────────────────────────────┐ │
│ │ 开始吧！能详细描述一下  │ │ │ 📊 完善进度                        │ │
│ │ 您设想的典型用户吗？    │ │ │ ████████░░ 80%                     │ │
│ │ [12:30]                 │ │ │ • 目标用户: 已完善 ✓               │ │
│ │                         │ │ │ • 商业模式: 进行中...              │ │
│ │ [用户头像] 您           │ │ └────────────────────────────────────┘ │
│ │ 我的目标用户主要是...   │ │                                        │
│ │ [12:31]                 │ │ ┌────────────────────────────────────┐ │
│ │                         │ │ │ 🎯 下一步操作                      │ │
│ │ ↓ 滚动查看更多          │ │ │ [继续完善其他维度]                 │ │
│ └─────────────────────────┘ │ │ [进入MVP构建工作坊] →              │ │
│                             │ │ [保存并退出]                       │ │
│ ┌─────────────────────────┐ │ └────────────────────────────────────┘ │
│ │ 💬 [输入您的回答...]    │ │                                        │
│ │            [发送] [📎] │ │                                        │
│ └─────────────────────────┘ │                                        │
└─────────────────────────────┴────────────────────────────────────────┘
```

### 视觉设计规范

#### 颜色方案
- **主色调**: 蓝色系 (#3B82F6)
- **警告色**: 橙色 (#F97316) - 薄弱维度标记
- **成功色**: 绿色 (#10B981) - 完善后的维度
- **背景色**:
  - 左侧对话区: 白色 (#FFFFFF)
  - 右侧文档区: 浅灰 (#F9FAFB)

#### 图标使用
- 📊 评估总结
- 💬 AI对话
- 📝 文档编辑
- ⚠️ 需要完善
- ✓ 已完善
- ⚡ 正在完善
- 💡 AI建议/提示

---

## 🏗️ 技术架构

### 组件结构

```
src/
├── components/
│   └── workshop/
│       ├── IdeaRefinementWorkshop.tsx      # 主组件
│       ├── BiddingSummary.tsx              # 竞价评估总结
│       ├── AIConversation.tsx              # AI对话界面
│       ├── RefinedDocumentView.tsx         # 完善文档展示
│       └── ProgressTracker.tsx             # 进度追踪
├── app/
│   ├── workshops/
│   │   └── [workshopId]/
│   │       └── page.tsx                    # 更新路由逻辑
│   └── api/
│       └── workshop/
│           └── refine-idea/
│               └── route.ts                # DeepSeek API集成
└── types/
    └── workshop.ts                         # 类型定义
```

### 数据流架构

```
┌─────────────────────┐
│  sessionStorage     │
│  - biddingData      │ ──┐
│  - ideaContent      │   │
│  - maturityScore    │   │
└─────────────────────┘   │
                          ↓
┌─────────────────────────────────────┐
│  IdeaRefinementWorkshop Component   │
│  - 读取竞价数据                     │
│  - 分析薄弱维度                     │
│  - 初始化对话状态                   │
└─────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────┐
│  AI引导对话循环                     │
│  ┌───────────────────────────────┐  │
│  │ 维度1: 目标客户 (5轮)        │  │
│  │ ├─ 第1轮: AI识别问题 + 提问  │  │
│  │ ├─ 第2轮: AI追问细节         │  │
│  │ ├─ 第3轮: AI深入挖掘         │  │
│  │ ├─ 第4轮: AI给出建议         │  │
│  │ └─ 第5轮: AI总结 + 确认      │  │
│  └───────────────────────────────┘  │
│  ↓                                   │
│  ┌───────────────────────────────┐  │
│  │ 维度2: 商业模式 (5轮)        │  │
│  │ ...                          │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────┐
│  完善文档生成                       │
│  - 结构化存储                       │
│  - 实时更新显示                     │
│  - 支持导出                         │
└─────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────┐
│  用户选择                           │
│  ├─ 继续完善 → 重新进入对话         │
│  ├─ 进入MVP → /workshops/mvp-builder│
│  └─ 保存退出 → 保存到数据库         │
└─────────────────────────────────────┘
```

---

## 💻 代码实现规划

### 1. 类型定义 (src/types/workshop.ts)

```typescript
// 竞价维度
export interface DimensionScore {
  name: string;              // 维度名称
  score: number;             // 得分 (0-10)
  threshold: number;         // 及格线 (通常7.0)
  needsRefinement: boolean;  // 是否需要完善
  originalContent?: string;  // 原始内容
  refinedContent?: string;   // 完善后内容
}

// 对话消息
export interface ConversationMessage {
  id: string;
  role: 'ai' | 'user';
  content: string;
  timestamp: Date;
  dimension?: string;        // 关联的维度
  round?: number;            // 第几轮对话
}

// 完善状态
export interface RefinementState {
  currentDimension: string;  // 当前正在完善的维度
  currentRound: number;      // 当前轮次 (1-5)
  completedDimensions: string[];  // 已完善的维度
  pendingDimensions: string[];    // 待完善的维度
  refinedDocument: RefinedIdeaDocument;  // 完善后的文档
}

// 完善后的文档
export interface RefinedIdeaDocument {
  basicInfo: {
    title: string;
    industry: string;
    description: string;
  };
  targetUser: {
    userGroup: string;         // 用户群体
    typicalPersona: string;    // 典型画像
    corePainPoints: string[];  // 核心痛点
    usageScenarios: string[];  // 使用场景
    paymentWillingness: string; // 支付意愿
  };
  businessModel: {
    revenueStreams: string[];  // 收入来源
    pricingStrategy: string;   // 定价策略
    costStructure: string;     // 成本结构
    keyPartners: string[];     // 关键合作伙伴
  };
  marketAnalysis: {
    marketSize: string;        // 市场规模
    competitors: string[];     // 主要竞争对手
    competitiveAdvantage: string[];  // 竞争优势
    barriers: string[];        // 进入壁垒
  };
  implementation: {
    coreFeatures: string[];    // 核心功能
    technicalApproach: string; // 技术路线
    timeline: string;          // 实施时间表
    resources: string[];       // 所需资源
  };
}
```

### 2. 主组件 (src/components/workshop/IdeaRefinementWorkshop.tsx)

```typescript
'use client'

import React, { useState, useEffect } from 'react'
import { Card } from '@/components/ui/card'
import BiddingSummary from './BiddingSummary'
import AIConversation from './AIConversation'
import RefinedDocumentView from './RefinedDocumentView'
import ProgressTracker from './ProgressTracker'

interface IdeaRefinementWorkshopProps {
  userId: string
}

export default function IdeaRefinementWorkshop({ userId }: IdeaRefinementWorkshopProps) {
  // 状态管理
  const [biddingData, setBiddingData] = useState(null)
  const [dimensions, setDimensions] = useState<DimensionScore[]>([])
  const [refinementState, setRefinementState] = useState<RefinementState | null>(null)
  const [conversationHistory, setConversationHistory] = useState<ConversationMessage[]>([])
  const [isLoading, setIsLoading] = useState(true)

  // 加载竞价数据
  useEffect(() => {
    loadBiddingData()
  }, [])

  const loadBiddingData = () => {
    try {
      const savedData = sessionStorage.getItem('biddingData')
      const ideaContent = sessionStorage.getItem('biddingIdeaContent')

      if (savedData && ideaContent) {
        const data = JSON.parse(savedData)
        setBiddingData(data)

        // 分析薄弱维度
        const weakDimensions = analyzeDimensions(data)
        setDimensions(weakDimensions)

        // 初始化完善状态
        initializeRefinementState(weakDimensions, ideaContent)

        // 生成AI欢迎消息
        generateWelcomeMessage(weakDimensions)
      }

      setIsLoading(false)
    } catch (error) {
      console.error('加载竞价数据失败:', error)
      setIsLoading(false)
    }
  }

  // 分析薄弱维度
  const analyzeDimensions = (data: any): DimensionScore[] => {
    const scores = data.maturityAssessment?.dimensionScores || {}
    const threshold = 7.0

    return Object.entries(scores).map(([name, score]: [string, any]) => ({
      name: translateDimensionName(name),
      score: score,
      threshold,
      needsRefinement: score < threshold,
      originalContent: extractOriginalContent(data, name)
    })).filter(d => d.needsRefinement)
  }

  // 初始化完善状态
  const initializeRefinementState = (dimensions: DimensionScore[], ideaContent: string) => {
    const pendingDims = dimensions.map(d => d.name)

    setRefinementState({
      currentDimension: pendingDims[0] || '',
      currentRound: 1,
      completedDimensions: [],
      pendingDimensions: pendingDims,
      refinedDocument: {
        basicInfo: {
          title: extractTitle(ideaContent),
          industry: '',
          description: ideaContent
        },
        targetUser: {
          userGroup: '',
          typicalPersona: '',
          corePainPoints: [],
          usageScenarios: [],
          paymentWillingness: ''
        },
        businessModel: {
          revenueStreams: [],
          pricingStrategy: '',
          costStructure: '',
          keyPartners: []
        },
        marketAnalysis: {
          marketSize: '',
          competitors: [],
          competitiveAdvantage: [],
          barriers: []
        },
        implementation: {
          coreFeatures: [],
          technicalApproach: '',
          timeline: '',
          resources: []
        }
      }
    })
  }

  // 生成欢迎消息
  const generateWelcomeMessage = async (dimensions: DimensionScore[]) => {
    const welcomeMsg: ConversationMessage = {
      id: generateId(),
      role: 'ai',
      content: `您好！我是您的创意完善教练。🎯

通过分析6位AI专家的评估，我发现您的创意在以下${dimensions.length}个维度还需要进一步完善：

${dimensions.map((d, i) => `${i + 1}. **${d.name}** (当前得分: ${d.score}/10)`).join('\n')}

让我们逐个深入完善这些维度，让您的创意更加完整和可行！`,
      timestamp: new Date()
    }

    setConversationHistory([welcomeMsg])

    // 延迟1秒后发送第一个引导问题
    setTimeout(() => {
      generateGuidingQuestion(dimensions[0], 1)
    }, 1000)
  }

  // 生成引导问题
  const generateGuidingQuestion = async (dimension: DimensionScore, round: number) => {
    try {
      const response = await fetch('/api/workshop/refine-idea', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          dimension: dimension.name,
          round,
          originalContent: dimension.originalContent,
          conversationHistory: conversationHistory.slice(-5),
          refinedDocument: refinementState?.refinedDocument
        })
      })

      const result = await response.json()

      const aiMsg: ConversationMessage = {
        id: generateId(),
        role: 'ai',
        content: result.question,
        timestamp: new Date(),
        dimension: dimension.name,
        round
      }

      setConversationHistory(prev => [...prev, aiMsg])

    } catch (error) {
      console.error('生成引导问题失败:', error)
    }
  }

  // 处理用户回答
  const handleUserResponse = async (userInput: string) => {
    if (!refinementState) return

    // 添加用户消息
    const userMsg: ConversationMessage = {
      id: generateId(),
      role: 'user',
      content: userInput,
      timestamp: new Date(),
      dimension: refinementState.currentDimension,
      round: refinementState.currentRound
    }

    setConversationHistory(prev => [...prev, userMsg])

    // 调用AI处理回答
    try {
      const response = await fetch('/api/workshop/refine-idea', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          dimension: refinementState.currentDimension,
          round: refinementState.currentRound,
          userResponse: userInput,
          conversationHistory: conversationHistory.slice(-5),
          refinedDocument: refinementState.refinedDocument
        })
      })

      const result = await response.json()

      // 更新文档
      if (result.documentUpdate) {
        setRefinementState(prev => ({
          ...prev!,
          refinedDocument: {
            ...prev!.refinedDocument,
            ...result.documentUpdate
          }
        }))
      }

      // 添加AI回复
      const aiMsg: ConversationMessage = {
        id: generateId(),
        role: 'ai',
        content: result.response,
        timestamp: new Date(),
        dimension: refinementState.currentDimension,
        round: refinementState.currentRound
      }

      setConversationHistory(prev => [...prev, aiMsg])

      // 更新状态：进入下一轮或下一维度
      if (refinementState.currentRound < 5) {
        // 继续当前维度的下一轮
        setRefinementState(prev => ({
          ...prev!,
          currentRound: prev!.currentRound + 1
        }))

        // 生成下一轮问题
        setTimeout(() => {
          const currentDim = dimensions.find(d => d.name === refinementState.currentDimension)
          if (currentDim) {
            generateGuidingQuestion(currentDim, refinementState.currentRound + 1)
          }
        }, 1000)

      } else {
        // 当前维度完成，进入下一维度
        const remainingDims = refinementState.pendingDimensions.filter(
          d => d !== refinementState.currentDimension
        )

        setRefinementState(prev => ({
          ...prev!,
          completedDimensions: [...prev!.completedDimensions, prev!.currentDimension],
          pendingDimensions: remainingDims,
          currentDimension: remainingDims[0] || '',
          currentRound: 1
        }))

        if (remainingDims.length > 0) {
          // 还有待完善维度
          setTimeout(() => {
            const nextDim = dimensions.find(d => d.name === remainingDims[0])
            if (nextDim) {
              generateGuidingQuestion(nextDim, 1)
            }
          }, 1000)
        } else {
          // 所有维度完成
          generateCompletionMessage()
        }
      }

    } catch (error) {
      console.error('处理用户回答失败:', error)
    }
  }

  // 生成完成消息
  const generateCompletionMessage = () => {
    const completionMsg: ConversationMessage = {
      id: generateId(),
      role: 'ai',
      content: `🎉 太棒了！我们已经完成了所有维度的完善！

您的创意现在更加清晰和完整了。右侧的文档展示了所有优化后的内容。

**下一步您可以：**
1. 📝 继续完善其他细节
2. 🚀 进入MVP构建工作坊，开始原型开发
3. 💾 保存当前内容，稍后继续

您想选择哪一个呢？`,
      timestamp: new Date()
    }

    setConversationHistory(prev => [...prev, completionMsg])
  }

  // 辅助函数
  const generateId = () => Math.random().toString(36).substring(7)
  const translateDimensionName = (name: string) => {
    const map: Record<string, string> = {
      'targetCustomer': '目标客户',
      'coreValue': '核心价值',
      'businessModel': '商业模式',
      'marketPotential': '市场潜力'
    }
    return map[name] || name
  }
  const extractOriginalContent = (data: any, dimension: string) => {
    // 从竞价数据中提取该维度的原始描述
    return ''
  }
  const extractTitle = (content: string) => {
    return content.split('\n')[0].substring(0, 50)
  }

  if (isLoading) {
    return <div className="flex justify-center items-center h-screen">加载中...</div>
  }

  return (
    <div className="h-screen flex flex-col bg-gray-50">
      {/* 顶部标题栏 */}
      <div className="bg-white border-b p-4">
        <h1 className="text-xl font-bold">🎯 创意完善工作坊</h1>
        <p className="text-sm text-gray-600">AI引导式创意优化系统</p>
      </div>

      {/* 主要内容 - 双栏布局 */}
      <div className="flex-1 flex overflow-hidden">
        {/* 左侧：评估总结 + AI对话 */}
        <div className="w-[45%] border-r flex flex-col bg-white">
          <BiddingSummary
            dimensions={dimensions}
            refinementState={refinementState}
          />

          <AIConversation
            conversationHistory={conversationHistory}
            onUserResponse={handleUserResponse}
            isProcessing={false}
          />
        </div>

        {/* 右侧：完善文档 + 进度追踪 */}
        <div className="w-[55%] flex flex-col bg-gray-50">
          <RefinedDocumentView
            refinedDocument={refinementState?.refinedDocument}
            currentDimension={refinementState?.currentDimension}
          />

          <ProgressTracker
            completedDimensions={refinementState?.completedDimensions || []}
            pendingDimensions={refinementState?.pendingDimensions || []}
            onContinue={() => {}}
            onEnterMVP={() => window.location.href = '/workshops/mvp-builder'}
            onSaveAndExit={() => {}}
          />
        </div>
      </div>
    </div>
  )
}
```

### 3. API路由 (src/app/api/workshop/refine-idea/route.ts)

```typescript
import { NextRequest, NextResponse } from 'next/server'
import { callDeepSeekAPI } from '@/lib/ai/deepseek-client'

export const runtime = 'edge'
export const dynamic = 'force-dynamic'

export async function POST(request: NextRequest) {
  try {
    const body = await request.json()
    const {
      dimension,
      round,
      userResponse,
      originalContent,
      conversationHistory,
      refinedDocument
    } = body

    // 构建系统提示词
    const systemPrompt = buildSystemPrompt(dimension, round)

    // 构建用户消息
    const userMessage = buildUserMessage(
      dimension,
      round,
      userResponse,
      originalContent,
      refinedDocument
    )

    // 调用DeepSeek API
    const aiResponse = await callDeepSeekAPI(
      [
        { role: 'system', content: systemPrompt },
        ...conversationHistory.slice(-3).map((msg: any) => ({
          role: msg.role === 'ai' ? 'assistant' : 'user',
          content: msg.content
        })),
        { role: 'user', content: userMessage }
      ],
      {
        temperature: 0.7,
        max_tokens: 2000
      }
    )

    // 解析AI响应，提取文档更新
    const documentUpdate = extractDocumentUpdate(
      aiResponse.content,
      dimension,
      userResponse
    )

    return NextResponse.json({
      success: true,
      response: aiResponse.content,
      documentUpdate,
      nextRound: round < 5 ? round + 1 : null
    })

  } catch (error) {
    console.error('创意完善API失败:', error)
    return NextResponse.json(
      {
        success: false,
        error: '处理失败，请稍后重试'
      },
      { status: 500 }
    )
  }
}

// 构建系统提示词
function buildSystemPrompt(dimension: string, round: number): string {
  const basePrompt = `你是一位专业的创意孵化教练。你的任务是通过主动提问，引导用户完善创意的【${dimension}】维度。

**核心原则:**
1. 主动引导，不要被动回答
2. 每次聚焦一个具体问题
3. 给出具体、可操作的建议
4. 避免泛泛而谈

**当前轮次:** 第${round}轮/共5轮`

  const roundStrategies: Record<number, string> = {
    1: `
**第1轮目标:** 识别问题，提出核心问题
- 指出该维度目前的不足
- 提出一个开放式的核心问题
- 引导用户描述现状`,

    2: `
**第2轮目标:** 深入细节，追问具体信息
- 基于用户的回答追问细节
- 挖掘具体的数字、场景、案例
- 避免模糊描述`,

    3: `
**第3轮目标:** 拓展思考，引导多角度分析
- 引导用户从不同角度思考
- 提出"如果...会怎样"的假设
- 挑战用户的假设`,

    4: `
**第4轮目标:** 给出建议，提供具体方案
- 总结用户的描述
- 给出3-5个具体建议
- 询问用户对哪个建议最感兴趣`,

    5: `
**第5轮目标:** 总结完善，确认理解
- 总结该维度的完善内容
- 确认用户是否满意
- 预告下一个维度`
  }

  return basePrompt + '\n' + roundStrategies[round]
}

// 构建用户消息
function buildUserMessage(
  dimension: string,
  round: number,
  userResponse: string,
  originalContent: string,
  refinedDocument: any
): string {
  if (round === 1) {
    return `用户的创意原始描述中关于【${dimension}】的内容：
${originalContent || '未提供'}

请生成第1轮的引导问题。`
  } else {
    return `用户对第${round - 1}轮问题的回答：
${userResponse}

当前已完善的内容：
${JSON.stringify(refinedDocument, null, 2)}

请生成第${round}轮的引导问题或建议。`
  }
}

// 提取文档更新
function extractDocumentUpdate(
  aiResponse: string,
  dimension: string,
  userResponse: string
): any {
  // 解析用户回答，提取结构化信息
  // 这里需要根据维度类型进行智能解析

  const update: any = {}

  if (dimension === '目标客户') {
    update.targetUser = {
      // 从userResponse中提取用户群体、痛点等
    }
  } else if (dimension === '商业模式') {
    update.businessModel = {
      // 从userResponse中提取收入来源、定价策略等
    }
  }

  return update
}
```

---

## 📊 AI Prompt 设计

### 对话策略矩阵

| 轮次 | 目标 | AI行为 | 示例 |
|-----|------|--------|------|
| **第1轮** | 识别问题 | 指出不足 + 开放式提问 | "我注意到您对目标客户的描述比较笼统。能详细说说您设想的典型用户是谁吗？" |
| **第2轮** | 深入细节 | 追问具体信息 | "您提到的职场人群，他们的年龄段、职位、收入水平大概是怎样的？" |
| **第3轮** | 拓展思考 | 多角度分析 | "如果这些用户目前是手动处理这个问题的，他们每天大约花多少时间？" |
| **第4轮** | 给出建议 | 3-5个具体方案 | "基于您的描述，我建议：1) 细分为3类用户画像 2) 量化痛点损失 3) 调研支付意愿" |
| **第5轮** | 总结确认 | 总结 + 预告 | "太好了！关于目标客户，我们现在有了清晰的画像。接下来让我们完善商业模式..." |

### 维度特定Prompt

#### 目标客户维度
```
你正在帮助用户完善【目标客户】维度。

需要收集的信息:
1. 用户群体 (Who): 年龄、职业、收入、地域
2. 核心痛点 (Pain): 具体遇到什么问题
3. 使用场景 (When/Where): 什么时候、什么地方需要
4. 支付意愿 (Why): 为什么愿意付费
5. 典型画像 (Persona): 1-2个具体的用户故事

引导策略:
- 第1轮: 询问"谁会用您的产品？"
- 第2轮: 追问"他们遇到了什么具体问题？"
- 第3轮: 询问"他们现在如何解决这个问题？"
- 第4轮: 建议"如何验证这些用户真的存在？"
- 第5轮: 总结用户画像
```

#### 商业模式维度
```
你正在帮助用户完善【商业模式】维度。

需要收集的信息:
1. 收入来源 (Revenue): 如何赚钱
2. 定价策略 (Pricing): 收费多少、如何收费
3. 成本结构 (Cost): 主要开支
4. 关键合作伙伴 (Partners): 需要哪些合作方

引导策略:
- 第1轮: 询问"您打算如何从这个创意中获得收入？"
- 第2轮: 追问"用户愿意为此支付多少钱？"
- 第3轮: 询问"运营这个业务的主要成本是什么？"
- 第4轮: 建议"可以参考哪些成功案例的商业模式？"
- 第5轮: 总结商业模式设计
```

---

## 🔄 完善文档结构

### 结构化表单设计

```typescript
// 完善后的文档结构
{
  // 基本信息
  basicInfo: {
    title: "智能XXX平台",
    industry: "教育科技",
    description: "...",
    lastUpdated: "2025-10-25T12:30:00Z"
  },

  // 目标用户 (5轮对话完善)
  targetUser: {
    userGroup: "25-35岁的职场白领",
    typicalPersona: "张三，28岁，互联网公司产品经理，年薪30万...",
    corePainPoints: [
      "时间管理效率低",
      "团队协作沟通成本高",
      "项目进度难以追踪"
    ],
    usageScenarios: [
      "每天早上制定工作计划",
      "团队会议记录和任务分配",
      "项目里程碑检查"
    ],
    paymentWillingness: "每月愿意支付99-299元订阅费"
  },

  // 商业模式 (5轮对话完善)
  businessModel: {
    revenueStreams: [
      "SaaS订阅费 (主要收入)",
      "企业定制服务",
      "API调用费用"
    ],
    pricingStrategy: "freemium模式，个人版免费，团队版199元/月，企业版999元/月",
    costStructure: "服务器成本、AI API费用、人力成本",
    keyPartners: ["云服务商", "支付平台", "企业客户渠道商"]
  },

  // 市场分析
  marketAnalysis: {
    marketSize: "中国项目管理软件市场约200亿元",
    competitors: ["石墨文档", "飞书", "Notion"],
    competitiveAdvantage: [
      "AI智能推荐",
      "深度集成微信生态",
      "更符合中国用户习惯"
    ],
    barriers: ["品牌认知度", "用户迁移成本"]
  },

  // 实施计划
  implementation: {
    coreFeatures: [
      "智能任务规划",
      "团队协作看板",
      "AI进度预测"
    ],
    technicalApproach: "Next.js + PostgreSQL + DeepSeek API",
    timeline: "3个月MVP，6个月正式版",
    resources: ["2名全栈工程师", "1名产品经理", "50万启动资金"]
  }
}
```

### 实时更新显示

右侧文档展示时，根据当前正在完善的维度高亮显示：

```tsx
<div className="space-y-6 p-6">
  {/* 目标用户板块 */}
  <div className={`
    p-4 rounded-lg border-2
    ${currentDimension === '目标客户'
      ? 'border-blue-500 bg-blue-50'
      : 'border-gray-200 bg-white'}
  `}>
    <h3 className="font-bold flex items-center gap-2">
      👥 目标用户画像
      {currentDimension === '目标客户' && (
        <span className="text-xs bg-blue-500 text-white px-2 py-1 rounded">
          ⚡ 正在完善
        </span>
      )}
    </h3>

    {/* 原始版本（灰色） */}
    <div className="mt-2 p-2 bg-gray-100 rounded">
      <p className="text-xs text-gray-500">原始版本:</p>
      <p className="text-sm text-gray-600">{originalContent}</p>
    </div>

    {/* 优化后版本（高亮） */}
    {refinedContent && (
      <div className="mt-2 p-2 bg-green-50 border border-green-200 rounded">
        <p className="text-xs text-green-700">✓ 优化后:</p>
        <div className="text-sm space-y-1">
          <p><strong>用户群体:</strong> {refinedContent.userGroup}</p>
          <p><strong>典型画像:</strong> {refinedContent.typicalPersona}</p>
          <p><strong>核心痛点:</strong></p>
          <ul className="list-disc list-inside">
            {refinedContent.corePainPoints.map((pain, i) => (
              <li key={i}>{pain}</li>
            ))}
          </ul>
        </div>
      </div>
    )}
  </div>

  {/* 商业模式板块 */}
  <div className={/* 类似结构 */}>
    ...
  </div>
</div>
```

---

## 🎯 完成后的操作选择

### 三个选择按钮设计

```tsx
<div className="p-4 bg-white border-t">
  <h4 className="font-semibold mb-3">🎯 下一步操作</h4>

  <div className="space-y-2">
    {/* 选项1: 继续完善 */}
    <Button
      variant="outline"
      className="w-full justify-start"
      onClick={onContinueRefinement}
    >
      <RefreshCw className="w-4 h-4 mr-2" />
      继续完善其他维度
      <span className="ml-auto text-xs text-gray-500">
        重新进入对话
      </span>
    </Button>

    {/* 选项2: 进入MVP */}
    <Button
      className="w-full justify-start bg-gradient-to-r from-blue-500 to-purple-600"
      onClick={onEnterMVP}
    >
      <Rocket className="w-4 h-4 mr-2" />
      进入MVP构建工作坊
      <ArrowRight className="w-4 h-4 ml-auto" />
    </Button>

    {/* 选项3: 保存退出 */}
    <Button
      variant="ghost"
      className="w-full justify-start"
      onClick={onSaveAndExit}
    >
      <Save className="w-4 h-4 mr-2" />
      保存并退出
      <span className="ml-auto text-xs text-gray-500">
        稍后继续
      </span>
    </Button>
  </div>

  {/* 保存状态提示 */}
  <div className="mt-3 p-2 bg-blue-50 rounded text-xs text-gray-600">
    💡 提示：您的进度会自动保存到云端
  </div>
</div>
```

---

## 🚀 实施计划

### Phase 1: 基础架构 (2-3小时)
- [x] 创建类型定义
- [ ] 创建主组件结构
- [ ] 实现数据加载逻辑
- [ ] 设置sessionStorage读取

### Phase 2: UI组件 (3-4小时)
- [ ] BiddingSummary 组件
- [ ] AIConversation 组件
- [ ] RefinedDocumentView 组件
- [ ] ProgressTracker 组件
- [ ] 响应式布局调整

### Phase 3: AI集成 (2-3小时)
- [ ] API路由实现
- [ ] DeepSeek Prompt设计
- [ ] 对话状态管理
- [ ] 文档更新逻辑

### Phase 4: 测试优化 (1-2小时)
- [ ] 端到端流程测试
- [ ] 边界情况处理
- [ ] 性能优化
- [ ] 用户体验微调

**总预计时间: 8-12小时**

---

## 📝 测试清单

### 功能测试
- [ ] 竞价数据正确加载
- [ ] 薄弱维度准确识别
- [ ] AI生成的问题相关且有深度
- [ ] 每个维度完整走完5轮对话
- [ ] 文档实时更新正确
- [ ] 进度追踪显示准确
- [ ] 完成后三个选项都能正常工作

### 集成测试
- [ ] 从竞价页面跳转正常
- [ ] 进入MVP工作坊数据传递正确
- [ ] sessionStorage数据持久化
- [ ] 多标签页数据同步

### 性能测试
- [ ] 对话响应速度 < 2秒
- [ ] 文档更新无延迟
- [ ] 大量对话历史不卡顿
- [ ] DeepSeek API调用稳定

---

## 🔐 注意事项

### 数据安全
- sessionStorage敏感数据加密
- API调用添加用户认证
- 防止XSS攻击

### 用户体验
- 加载状态清晰反馈
- 错误提示友好
- 支持中途保存
- 防止意外退出丢失数据

### 可扩展性
- 维度配置化，便于增加新维度
- AI Prompt模板化
- 文档结构灵活扩展

---

## 📚 相关文档
- [MVP构建工作坊设计文档](./MVP工作坊技术文档.md)
- [DeepSeek API接口文档](../api/deepseek-integration.md)
- [工作坊系统架构](./workshop-system-architecture.md)

---

**文档版本**: v1.0
**最后更新**: 2025-10-25
**作者**: Claude Code
**状态**: 待实施
